<!DOCTYPE html>
<!--
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                    PROTOCOLE D'ASSOCIATION - BLAN'LIA STUDIO                  ‚ïë
‚ïë                    Version FULL EDITABLE avec Firebase                        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
-->
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protocole d'Association - BLAN'LIA STUDIO & KEF Ventures</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root{--primary-dark:#1a1f2e;--primary-navy:#252d3d;--accent-gold:#c9a227;--accent-gold-light:#e8d5a3;--accent-gold-dark:#a68620;--text-dark:#1e293b;--text-medium:#475569;--text-light:#64748b;--bg-cream:#fdfcfa;--bg-white:#fff;--border-light:#e2e8f0;--success:#10b981;--warning:#f59e0b;--error:#ef4444;--info:#3b82f6}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Source Sans 3',sans-serif;background:linear-gradient(145deg,#f1f5f9,#e2e8f0);min-height:100vh;color:var(--text-dark);line-height:1.7}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(15,23,42,.95);z-index:5000;display:flex;align-items:center;justify-content:center;padding:20px;transition:all .3s}.modal-overlay.hidden{opacity:0;visibility:hidden;pointer-events:none}.modal-content{background:#fff;border-radius:16px;max-width:700px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 25px 80px rgba(0,0,0,.4);animation:modalSlideIn .3s}@keyframes modalSlideIn{from{opacity:0;transform:translateY(-30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.modal-header{background:linear-gradient(135deg,var(--primary-dark),var(--primary-navy));padding:28px 32px;border-radius:16px 16px 0 0}.modal-header h2{color:#fff;font-family:'Playfair Display',serif;font-size:1.6rem;margin-bottom:6px}.modal-header p{color:rgba(255,255,255,.7);font-size:.9rem}.modal-body{padding:28px 32px}.config-tabs{display:flex;gap:10px;margin-bottom:22px}.config-tab{flex:1;padding:11px 18px;border:2px solid var(--border-light);border-radius:8px;background:#fff;font-family:'Source Sans 3',sans-serif;font-size:.9rem;font-weight:600;color:var(--text-medium);cursor:pointer;transition:all .2s;text-align:center}.config-tab:hover{border-color:var(--accent-gold-light);color:var(--text-dark)}.config-tab.active{border-color:var(--accent-gold);background:linear-gradient(135deg,rgba(201,162,39,.1),rgba(201,162,39,.05));color:var(--accent-gold-dark)}.config-panel{display:none}.config-panel.active{display:block}.setup-step{display:flex;gap:14px;padding:16px;background:var(--bg-cream);border-radius:10px;margin-bottom:10px;border-left:4px solid var(--accent-gold)}.step-number{background:var(--accent-gold);color:var(--primary-dark);width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.8rem;font-weight:700;flex-shrink:0}.step-content h4{color:var(--text-dark);font-size:.9rem;margin-bottom:4px}.step-content p{color:var(--text-medium);font-size:.8rem;margin:0}.step-content code{background:var(--primary-dark);color:var(--accent-gold-light);padding:2px 6px;border-radius:4px;font-size:.75rem}.config-textarea{width:100%;padding:14px;border:2px solid var(--border-light);border-radius:8px;font-family:Monaco,Consolas,monospace;font-size:.78rem;min-height:160px;resize:vertical;transition:border-color .2s;background:#f8fafc;margin-top:12px}.config-textarea:focus{outline:none;border-color:var(--accent-gold);background:#fff}.modal-actions{display:flex;gap:12px;margin-top:22px}.modal-btn{flex:1;padding:13px 22px;border:none;border-radius:8px;font-family:'Source Sans 3',sans-serif;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:8px}.modal-btn-primary{background:linear-gradient(135deg,var(--accent-gold),var(--accent-gold-dark));color:var(--primary-dark)}.modal-btn-primary:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 25px rgba(201,162,39,.35)}.modal-btn-primary:disabled{opacity:.6;cursor:not-allowed}.modal-btn-secondary{background:var(--bg-cream);color:var(--text-dark);border:2px solid var(--border-light)}.modal-btn-secondary:hover{background:var(--border-light)}.config-status{padding:11px 14px;border-radius:8px;margin-top:14px;font-size:.85rem;display:none;align-items:center;gap:10px}.config-status.show{display:flex}.config-status.success{background:#ecfdf5;border:1px solid #a7f3d0;color:#065f46}.config-status.error{background:#fef2f2;border:1px solid #fecaca;color:#991b1b}.config-status.loading{background:#fffbeb;border:1px solid #fde68a;color:#92400e}.spinner-small{width:16px;height:16px;border:2px solid currentColor;border-top-color:transparent;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.toolbar{position:fixed;top:0;left:0;right:0;background:linear-gradient(135deg,var(--primary-dark),var(--primary-navy));padding:10px 18px;display:flex;justify-content:space-between;align-items:center;z-index:1000;box-shadow:0 4px 20px rgba(0,0,0,.2)}.toolbar-left{display:flex;align-items:center;gap:12px}.toolbar-logo{width:36px;height:36px;background:var(--accent-gold);border-radius:8px;display:flex;align-items:center;justify-content:center}.toolbar-logo svg{width:20px;height:20px}.toolbar-title{color:#fff;font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:600}.toolbar-center{display:flex;align-items:center;gap:12px}.connection-badge{display:flex;align-items:center;gap:7px;padding:5px 12px;border-radius:18px;font-size:.78rem;font-weight:500}.connection-badge .dot{width:7px;height:7px;border-radius:50%;background:currentColor}.connection-badge.online{background:rgba(16,185,129,.2);color:var(--success)}.connection-badge.syncing{background:rgba(245,158,11,.2);color:var(--warning)}.connection-badge.syncing .dot{animation:pulse 1s infinite}.connection-badge.offline{background:rgba(239,68,68,.2);color:var(--error)}@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.8)}}.users-badge{display:flex;align-items:center;gap:5px;padding:5px 12px;background:rgba(255,255,255,.1);border-radius:18px;color:rgba(255,255,255,.8);font-size:.78rem}.last-sync{color:rgba(255,255,255,.5);font-size:.72rem}.toolbar-right{display:flex;align-items:center;gap:8px}.toolbar-btn{padding:7px 14px;border:none;border-radius:6px;font-family:'Source Sans 3',sans-serif;font-weight:600;font-size:.8rem;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:5px}.toolbar-btn-primary{background:linear-gradient(135deg,var(--accent-gold),var(--accent-gold-dark));color:var(--primary-dark)}.toolbar-btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 15px rgba(201,162,39,.4)}.toolbar-btn-secondary{background:rgba(255,255,255,.1);color:#fff}.toolbar-btn-secondary:hover{background:rgba(255,255,255,.2)}.toolbar-btn-icon{padding:7px;background:rgba(255,255,255,.1);color:#fff;border-radius:6px}.toolbar-btn-icon:hover{background:rgba(255,255,255,.2)}.toast-container{position:fixed;bottom:18px;right:18px;z-index:4000;display:flex;flex-direction:column;gap:8px}.toast{background:#fff;padding:12px 18px;border-radius:10px;box-shadow:0 10px 40px rgba(0,0,0,.15);display:flex;align-items:center;gap:10px;min-width:260px;animation:toastSlideIn .3s;border-left:4px solid}@keyframes toastSlideIn{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}.toast.success{border-color:var(--success)}.toast.error{border-color:var(--error)}.toast.warning{border-color:var(--warning)}.toast.info{border-color:var(--info)}.toast-icon{width:22px;height:22px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:.85rem}.toast.success .toast-icon{background:#ecfdf5;color:var(--success)}.toast.error .toast-icon{background:#fef2f2;color:var(--error)}.toast.warning .toast-icon{background:#fffbeb;color:var(--warning)}.toast.info .toast-icon{background:#eff6ff;color:var(--info)}.toast-message{flex:1;font-size:.85rem;color:var(--text-dark)}.toast-close{background:none;border:none;color:var(--text-light);cursor:pointer;padding:3px}.main-container{max-width:880px;margin:0 auto;padding:75px 18px 50px}.document{background:var(--bg-white);box-shadow:0 25px 80px rgba(0,0,0,.1);border-radius:4px;overflow:hidden}.cover-page{min-height:620px;background:linear-gradient(160deg,var(--primary-dark),var(--primary-navy));padding:40px;display:flex;flex-direction:column;position:relative;overflow:hidden}.cover-page::before{content:'';position:absolute;top:-30%;right:-20%;width:60%;height:120%;background:radial-gradient(ellipse,rgba(201,162,39,.1),transparent 70%);pointer-events:none}.cover-page::after{content:'';position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--accent-gold),var(--accent-gold-light),var(--accent-gold))}.cover-top{text-align:center;position:relative;z-index:1}.cover-label{color:var(--accent-gold);font-size:.72rem;font-weight:600;letter-spacing:4px;text-transform:uppercase;margin-bottom:10px}.cover-main-title{color:#fff;font-family:'Playfair Display',serif;font-size:2rem;font-weight:700;letter-spacing:1px}.cover-parties{display:flex;justify-content:center;align-items:center;gap:22px;margin:30px 0;position:relative;z-index:1}.cover-party-box{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:20px 28px;text-align:center;min-width:200px}.cover-party-label{color:var(--accent-gold);font-size:.62rem;font-weight:600;letter-spacing:2px;text-transform:uppercase;margin-bottom:8px}.cover-party-name{color:#fff;font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:600;margin-bottom:4px}.cover-party-role{color:rgba(255,255,255,.6);font-size:.8rem}.cover-ampersand{color:var(--accent-gold);font-family:'Playfair Display',serif;font-size:1.6rem;font-weight:300}.cover-project{flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;position:relative;z-index:1}.cover-project-label{color:rgba(255,255,255,.5);font-size:.68rem;font-weight:600;letter-spacing:3px;text-transform:uppercase;margin-bottom:10px}.cover-project-name{color:var(--accent-gold);font-family:'Playfair Display',serif;font-size:2.2rem;font-weight:700;letter-spacing:2px;margin-bottom:6px}.cover-project-url{color:rgba(255,255,255,.6);font-size:.9rem}.cover-footer{display:flex;justify-content:center;align-items:center;gap:12px;flex-wrap:wrap;margin-top:auto;position:relative;z-index:1}.cover-footer-text{color:rgba(255,255,255,.7);font-size:.8rem}.cover-badge{display:inline-block;border:1px solid var(--accent-gold);color:var(--accent-gold);padding:5px 14px;border-radius:4px;font-size:.68rem;font-weight:600;letter-spacing:2px;text-transform:uppercase;margin-top:12px}
        
        /* EDITABLE STYLES */
        [contenteditable="true"]{background:rgba(201,162,39,.06);border:1px dashed rgba(201,162,39,.4);padding:2px 5px;border-radius:4px;transition:all .2s;outline:none}[contenteditable="true"]:hover{background:rgba(201,162,39,.12);border-style:solid}[contenteditable="true"]:focus{background:rgba(201,162,39,.15);border-color:var(--accent-gold);box-shadow:0 0 0 3px rgba(201,162,39,.12)}[contenteditable="true"].remote-editing{border-color:var(--info);background:rgba(59,130,246,.1);animation:remotePulse 2s infinite}@keyframes remotePulse{0%,100%{box-shadow:0 0 0 0 rgba(59,130,246,.3)}50%{box-shadow:0 0 0 4px rgba(59,130,246,.1)}}
        .editable-cover{background:rgba(255,255,255,.08);border:1px dashed rgba(255,255,255,.3);color:#fff;padding:3px 8px;border-radius:4px;display:inline-block;outline:none}.editable-cover:hover{background:rgba(255,255,255,.12);border-style:solid}.editable-cover:focus{background:rgba(255,255,255,.15);border-color:var(--accent-gold)}
        .editable-block{display:block;width:100%;min-height:40px;margin:5px 0}
        .editable-title{display:inline}
        
        .content-page{padding:40px 50px;background:var(--bg-white)}.toc-title{font-family:'Playfair Display',serif;font-size:1.5rem;color:var(--primary-dark);margin-bottom:18px;padding-bottom:10px;border-bottom:2px solid var(--accent-gold)}.toc-list{list-style:none}.toc-item{display:flex;align-items:baseline;padding:7px 0;border-bottom:1px dotted var(--border-light);cursor:pointer;transition:all .2s}.toc-item:hover{background:var(--bg-cream);padding-left:6px}.toc-number{color:var(--accent-gold);font-weight:600;min-width:100px;font-size:.8rem}.toc-text{flex:1;color:var(--text-dark);font-size:.9rem}.section{margin-bottom:35px}.section-header{display:flex;align-items:center;gap:10px;margin-bottom:18px;padding-bottom:8px;border-bottom:2px solid var(--primary-dark)}.section-number{background:var(--primary-dark);color:#fff;font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:700;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:4px;flex-shrink:0}.section-title{font-family:'Playfair Display',serif;font-size:1.25rem;color:var(--primary-dark);font-weight:600}.subsection{margin-bottom:22px;padding-left:15px;border-left:3px solid var(--accent-gold-light)}.subsection-header{display:flex;align-items:center;gap:7px;margin-bottom:10px}.subsection-number{color:var(--accent-gold);font-weight:700;font-size:.9rem}.subsection-title{font-family:'Playfair Display',serif;font-size:1rem;color:var(--text-dark);font-weight:600}.article{margin-bottom:15px}.article-header{font-weight:600;color:var(--primary-dark);margin-bottom:6px;font-size:.85rem}.article-content{color:var(--text-medium);text-align:justify;font-size:.85rem}.article-content p{margin-bottom:8px}.legal-list{list-style:none;margin:8px 0;padding-left:10px}.legal-list li{position:relative;padding-left:16px;margin-bottom:5px;color:var(--text-medium);font-size:.85rem}.legal-list li::before{content:'‚Ä¢';position:absolute;left:0;color:var(--accent-gold);font-weight:700}.legal-list.numbered{counter-reset:list-counter}.legal-list.numbered li{counter-increment:list-counter}.legal-list.numbered li::before{content:counter(list-counter) ".";font-weight:600}.legal-table{width:100%;border-collapse:collapse;margin:10px 0;font-size:.8rem}.legal-table th,.legal-table td{padding:7px 9px;text-align:left;border:1px solid var(--border-light)}.legal-table th{background:var(--primary-dark);color:#fff;font-weight:600;font-size:.75rem}.legal-table tr:nth-child(even){background:var(--bg-cream)}.highlight-box{background:linear-gradient(135deg,rgba(201,162,39,.08),rgba(201,162,39,.03));border:1px solid var(--accent-gold-light);border-radius:8px;padding:15px;margin:15px 0}.highlight-box-title{color:var(--accent-gold-dark);font-weight:600;margin-bottom:6px;font-size:.85rem}.warning-box{background:#fef3c7;border:1px solid #fde68a;border-radius:8px;padding:15px;margin:15px 0}.warning-box .highlight-box-title{color:#92400e}.warning-box p{color:#92400e;font-size:.8rem;margin:0}.signature-section{margin-top:40px;padding-top:22px;border-top:2px solid var(--primary-dark)}.signature-grid{display:grid;grid-template-columns:1fr 1fr;gap:35px;margin-top:22px}.signature-box{text-align:center;padding:18px;border:1px solid var(--border-light);border-radius:8px}.signature-label{color:var(--accent-gold);font-size:.68rem;font-weight:600;letter-spacing:1px;text-transform:uppercase;margin-bottom:6px}.signature-name{font-family:'Playfair Display',serif;font-size:.95rem;color:var(--primary-dark);font-weight:600;margin-bottom:45px}.signature-line{border-top:1px solid var(--text-dark);padding-top:6px;font-size:.72rem;color:var(--text-light)}.annexe{margin-top:25px;padding:18px;background:var(--bg-cream);border-radius:8px;border:1px solid var(--border-light)}.annexe-header{display:flex;align-items:center;gap:8px;margin-bottom:10px}.annexe-badge{background:var(--accent-gold);color:var(--primary-dark);padding:3px 9px;border-radius:10px;font-size:.68rem;font-weight:700}.annexe-title{font-family:'Playfair Display',serif;font-size:.95rem;color:var(--primary-dark)}.page-break{page-break-after:always;height:0}.loading-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(15,23,42,.9);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:3000;opacity:0;visibility:hidden;transition:all .3s}.loading-overlay.active{opacity:1;visibility:visible}.loading-spinner{width:42px;height:42px;border:4px solid rgba(201,162,39,.2);border-top-color:var(--accent-gold);border-radius:50%;animation:spin .8s linear infinite}.loading-text{color:#fff;margin-top:16px;font-size:.9rem}@media print{.toolbar,.modal-overlay,.toast-container{display:none!important}.main-container{padding:0;max-width:100%}.document{box-shadow:none}[contenteditable="true"],.editable-cover{background:transparent!important;border:none!important;padding:0!important;box-shadow:none!important}}@media (max-width:768px){.toolbar{flex-wrap:wrap;gap:8px;padding:8px 12px}.toolbar-center{order:3;width:100%;justify-content:center}.main-container{padding:110px 8px 35px}.cover-page{padding:25px 20px}.cover-parties{flex-direction:column}.cover-project-name{font-size:1.6rem}.content-page{padding:25px 20px}.signature-grid{grid-template-columns:1fr}.modal-content{margin:8px}.modal-body{padding:18px}}
    </style>
</head>
<body>
    <!-- MODAL CONFIG -->
    <div class="modal-overlay" id="configModal">
        <div class="modal-content">
            <div class="modal-header"><h2>‚öôÔ∏è Configuration du stockage</h2><p>Configurez Firebase pour synchroniser en temps r√©el</p></div>
            <div class="modal-body">
                <div class="config-tabs">
                    <button class="config-tab active" onclick="switchTab('firebase')">üî• Firebase (Temps r√©el)</button>
                    <button class="config-tab" onclick="switchTab('local')">üíæ Mode Hors-ligne</button>
                </div>
                <div class="config-panel active" id="panel-firebase">
                    <div class="setup-step"><div class="step-number">1</div><div class="step-content"><h4>Cr√©er un projet Firebase</h4><p>Allez sur <a href="https://console.firebase.google.com" target="_blank" style="color:var(--accent-gold)">console.firebase.google.com</a></p></div></div>
                    <div class="setup-step"><div class="step-number">2</div><div class="step-content"><h4>Activer Realtime Database</h4><p><code>Build</code> ‚Üí <code>Realtime Database</code> ‚Üí Mode test</p></div></div>
                    <div class="setup-step"><div class="step-number">3</div><div class="step-content"><h4>Copier la configuration</h4><p>‚öôÔ∏è Param√®tres ‚Üí Vos applications ‚Üí Web ‚Üí Copier</p></div></div>
                    <label style="display:block;font-weight:600;margin-top:18px;font-size:.9rem">Collez votre configuration :</label>
                    <textarea class="config-textarea" id="firebaseConfigInput" placeholder='{"apiKey":"...","databaseURL":"https://xxx.firebaseio.com",...}'></textarea>
                    <div class="config-status" id="configStatus"></div>
                    <div class="modal-actions">
                        <button class="modal-btn modal-btn-secondary" onclick="switchTab('local')">Mode hors-ligne</button>
                        <button class="modal-btn modal-btn-primary" id="btnConnect" onclick="connectFirebase()">üîó Connecter</button>
                    </div>
                </div>
                <div class="config-panel" id="panel-local">
                    <div class="highlight-box"><div class="highlight-box-title">üíæ Mode Hors-ligne</div><p style="color:var(--text-medium);font-size:.85rem;margin:0">Les modifications seront sauvegard√©es uniquement dans votre navigateur.</p></div>
                    <div class="warning-box"><p>‚ö†Ô∏è Pour partager les modifications, utilisez Firebase ou exportez en PDF.</p></div>
                    <div class="modal-actions">
                        <button class="modal-btn modal-btn-secondary" onclick="switchTab('firebase')">‚Üê Configurer Firebase</button>
                        <button class="modal-btn modal-btn-primary" onclick="useOfflineMode()">üíæ Mode hors-ligne</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- LOADING -->
    <div class="loading-overlay" id="loadingOverlay"><div class="loading-spinner"></div><div class="loading-text" id="loadingText">Chargement...</div></div>
    
    <!-- TOASTS -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- TOOLBAR -->
    <div class="toolbar">
        <div class="toolbar-left">
            <div class="toolbar-logo"><svg viewBox="0 0 24 24" fill="none" stroke="#1a1f2e" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg></div>
            <span class="toolbar-title">Protocole d'Association</span>
        </div>
        <div class="toolbar-center">
            <div class="connection-badge offline" id="connectionBadge"><span class="dot"></span><span id="connectionText">Non connect√©</span></div>
            <div class="users-badge" id="usersBadge" style="display:none"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg><span id="usersCount">1</span></div>
            <span class="last-sync" id="lastSync"></span>
        </div>
        <div class="toolbar-right">
            <button class="toolbar-btn toolbar-btn-secondary" onclick="restoreOriginal()"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>Restaurer</button>
            <button class="toolbar-btn toolbar-btn-primary" onclick="downloadPDF()"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>PDF</button>
            <button class="toolbar-btn toolbar-btn-icon" onclick="showSettings()" title="Param√®tres"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></button>
        </div>
    </div>

    <!-- DOCUMENT -->
    <div class="main-container">
        <div class="document" id="document">

            <!-- ===== COVER PAGE ===== -->
            <div class="cover-page">
                <div class="cover-top">
                    <div class="cover-label" contenteditable="true" data-field="cover_label">Document Confidentiel</div>
                    <h1 class="cover-main-title" contenteditable="true" data-field="cover_title">PROTOCOLE D'ASSOCIATION</h1>
                </div>
                <div class="cover-parties">
                    <div class="cover-party-box">
                        <div class="cover-party-label" contenteditable="true" data-field="party1_label">Partie 1 - Fondateur Technique</div>
                        <div class="cover-party-name" contenteditable="true" data-field="party1_name">Monsieur Jad [NOM]</div>
                        <div class="cover-party-role" contenteditable="true" data-field="party1_role">Cr√©ateur & D√©veloppeur</div>
                    </div>
                    <div class="cover-ampersand">&</div>
                    <div class="cover-party-box">
                        <div class="cover-party-label" contenteditable="true" data-field="party2_label">Partie 2 - Investisseur Strat√©gique</div>
                        <div class="cover-party-name" contenteditable="true" data-field="party2_name">KEF Ventures</div>
                        <div class="cover-party-role" contenteditable="true" data-field="party2_role">Repr√©sent√©e par M. Karim EL-FEKKAK</div>
                    </div>
                </div>
                <div class="cover-project">
                    <div class="cover-project-label" contenteditable="true" data-field="project_label">Projet</div>
                    <div class="cover-project-name" contenteditable="true" data-field="project_name">BLAN'LIA STUDIO</div>
                    <div class="cover-project-url" contenteditable="true" data-field="project_url">www.blanlia.ma</div>
                </div>
                <div class="cover-footer">
                    <span class="cover-footer-text">Fait √† <span class="editable-cover" contenteditable="true" data-field="cover_city">Casablanca</span></span>
                    <span class="cover-footer-text">le <span class="editable-cover" contenteditable="true" data-field="cover_date">____/____/2025</span></span>
                </div>
                <div style="text-align:center"><div class="cover-badge" contenteditable="true" data-field="cover_badge">CONFIDENTIEL</div></div>
            </div>

            <div class="page-break"></div>

            <!-- ===== TABLE DES MATI√àRES ===== -->
            <div class="content-page">
                <h2 class="toc-title" contenteditable="true" data-field="toc_title">Table des Mati√®res</h2>
                <ul class="toc-list">
                    <li class="toc-item" onclick="scrollToEl('preambule')"><span class="toc-number">‚Äî</span><span class="toc-text" contenteditable="true" data-field="toc_item_0">Pr√©ambule</span></li>
                    <li class="toc-item" onclick="scrollToEl('partie1')"><span class="toc-number">PARTIE 1</span><span class="toc-text" contenteditable="true" data-field="toc_item_1">Structure et Modalit√©s de la Newco</span></li>
                    <li class="toc-item" onclick="scrollToEl('partie2')"><span class="toc-number">PARTIE 2</span><span class="toc-text" contenteditable="true" data-field="toc_item_2">Gouvernance et Responsabilit√©s</span></li>
                    <li class="toc-item" onclick="scrollToEl('partie3')"><span class="toc-number">PARTIE 3</span><span class="toc-text" contenteditable="true" data-field="toc_item_3">Pacte d'Associ√©s</span></li>
                    <li class="toc-item" onclick="scrollToEl('partie4')"><span class="toc-number">PARTIE 4</span><span class="toc-text" contenteditable="true" data-field="toc_item_4">Plan d'Action Strat√©gique</span></li>
                    <li class="toc-item" onclick="scrollToEl('partie5')"><span class="toc-number">PARTIE 5</span><span class="toc-text" contenteditable="true" data-field="toc_item_5">Dispositions Financi√®res</span></li>
                    <li class="toc-item" onclick="scrollToEl('signatures')"><span class="toc-number">‚Äî</span><span class="toc-text" contenteditable="true" data-field="toc_item_6">Signatures</span></li>
                </ul>
            </div>

            <div class="page-break"></div>

            <!-- ===== PR√âAMBULE ===== -->
            <div class="content-page" id="preambule">
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">¬ß</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_preambule">Pr√©ambule</h2>
                    </div>
                    <div class="article">
                        <div class="article-content">
                            <p contenteditable="true" data-field="preambule_p1"><strong>ENTRE LES SOUSSIGN√âS :</strong></p>
                            <p contenteditable="true" data-field="preambule_p2"><strong>Monsieur Jad [NOM COMPLET]</strong>, de nationalit√© marocaine, n√© le [date], titulaire de la CIN n¬∞ [num√©ro], demeurant √† [adresse],</p>
                            <p contenteditable="true" data-field="preambule_p3" style="text-align:center;color:var(--primary-dark);font-weight:600">Ci-apr√®s ¬´ le Fondateur ¬ª</p>
                            <p contenteditable="true" data-field="preambule_p4" style="text-align:center;color:var(--accent-gold);font-weight:600">D'UNE PART,</p>
                            <p contenteditable="true" data-field="preambule_p5"><strong>KEF VENTURES</strong>, soci√©t√© [forme juridique] au capital de [montant] dirhams, RC [num√©ro] √† Casablanca, repr√©sent√©e par <strong>M. Karim EL-FEKKAK</strong>,</p>
                            <p contenteditable="true" data-field="preambule_p6" style="text-align:center;color:var(--primary-dark);font-weight:600">Ci-apr√®s ¬´ KEF Ventures ¬ª</p>
                            <p contenteditable="true" data-field="preambule_p7" style="text-align:center;color:var(--accent-gold);font-weight:600">D'AUTRE PART,</p>
                            <p contenteditable="true" data-field="preambule_p8" style="margin-top:20px"><strong>ATTENDU QUE</strong> le Fondateur a d√©velopp√© la solution SAAS ¬´ BLAN'LIA STUDIO ¬ª (www.blanlia.ma), plateforme d'IA pour l'architecture et l'immobilier offrant : conversion de croquis en rendus photor√©alistes, transformation 2D‚Üí3D, am√©lioration de plans, design d'int√©rieur automatis√© ;</p>
                            <p contenteditable="true" data-field="preambule_p9"><strong>ATTENDU QUE</strong> les Parties souhaitent cr√©er une soci√©t√© commune (¬´ Newco ¬ª) pour d√©velopper et commercialiser cette solution ;</p>
                            <p contenteditable="true" data-field="preambule_p10"><strong>IL A √âT√â CONVENU CE QUI SUIT :</strong></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-break"></div>

            <!-- ===== PARTIE 1 ===== -->
            <div class="content-page" id="partie1">
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">1</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_partie1">Structure et Modalit√©s de la Newco</h2>
                    </div>

                    <!-- Art 1.1 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_1_1_num">Art. 1.1</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_1_1_titre">Identification et Forme Juridique</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_1_1_p1"><strong>D√©nomination :</strong> ¬´ BLAN'LIA TECH ¬ª</p>
                                <p contenteditable="true" data-field="art_1_1_p2"><strong>Forme :</strong> SARL (loi n¬∞ 5-96) - souplesse adapt√©e aux startups, responsabilit√© limit√©e, transformation possible en SA</p>
                                <p contenteditable="true" data-field="art_1_1_p3"><strong>Si√®ge :</strong> [Adresse - Casablanca, Maroc]</p>
                                <p contenteditable="true" data-field="art_1_1_p4"><strong>Dur√©e :</strong> 99 ann√©es</p>
                                <p contenteditable="true" data-field="art_1_1_p5"><strong>Objet :</strong> Conception/exploitation de solutions SAAS architecture/immobilier, services IA, commercialisation par abonnement, conseil/formation, exploitation de PI</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 1.2 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_1_2_num">Art. 1.2</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_1_2_titre">Capital Social</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_1_2_p1"><strong>Capital :</strong> 100.000 DH = 1.000 parts de 100 DH</p>
                                <table class="legal-table">
                                    <tr>
                                        <th contenteditable="true" data-field="tab1_h1">Associ√©</th>
                                        <th contenteditable="true" data-field="tab1_h2">Apport</th>
                                        <th contenteditable="true" data-field="tab1_h3">Montant</th>
                                        <th contenteditable="true" data-field="tab1_h4">%</th>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab1_r1_c1"><strong>KEF Ventures</strong></td>
                                        <td contenteditable="true" data-field="tab1_r1_c2">Num√©raire</td>
                                        <td contenteditable="true" data-field="tab1_r1_c3">60.000 DH</td>
                                        <td contenteditable="true" data-field="tab1_r1_c4"><strong>60%</strong></td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab1_r2_c1"><strong>M. Jad</strong></td>
                                        <td contenteditable="true" data-field="tab1_r2_c2">Nature (PI)</td>
                                        <td contenteditable="true" data-field="tab1_r2_c3">40.000 DH</td>
                                        <td contenteditable="true" data-field="tab1_r2_c4"><strong>40%</strong></td>
                                    </tr>
                                </table>
                                <p contenteditable="true" data-field="art_1_2_p2" style="margin-top:12px"><strong>Apports en nature :</strong> Code source (15.000 DH), PI (10.000 DH), Marque (8.000 DH), Domaine (2.000 DH), Base users (5.000 DH)</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 1.3 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_1_3_num">Art. 1.3</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_1_3_titre">Propri√©t√© Intellectuelle</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_1_3_p1">‚Ä¢ <strong>Transfert :</strong> PI transf√©r√©e √† la Soci√©t√© √† titre d'apport</p>
                                <p contenteditable="true" data-field="art_1_3_p2">‚Ä¢ <strong>D√©veloppements futurs :</strong> Propri√©t√© exclusive de la Soci√©t√©</p>
                                <p contenteditable="true" data-field="art_1_3_p3">‚Ä¢ <strong>Protection marque :</strong> D√©p√¥t OMPIC + extension internationale (Madrid)</p>
                                <p contenteditable="true" data-field="art_1_3_p4">‚Ä¢ <strong>Non-concurrence :</strong> 3 ans apr√®s cessation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-break"></div>

            <!-- ===== PARTIE 2 ===== -->
            <div class="content-page" id="partie2">
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">2</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_partie2">Gouvernance et Responsabilit√©s</h2>
                    </div>

                    <!-- Art 2.1 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_2_1_num">Art. 2.1</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_2_1_titre">Direction</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_2_1_p1"><strong>G√©rant :</strong> M. Jad [NOM] (dur√©e ind√©termin√©e)</p>
                                <p contenteditable="true" data-field="art_2_1_p2"><strong>Comit√© de Direction :</strong> M. Jad + M. EL-FEKKAK | R√©union mensuelle | D√©cisions √† l'unanimit√©</p>
                                <p contenteditable="true" data-field="art_2_1_p3"><strong>Limitations G√©rant :</strong> D√©penses > 50.000 DH, embauches salaire > 150.000 DH/an, contrats > 100.000 DH ‚Üí Comit√© | Emprunts ‚Üí Assembl√©e</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 2.2 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_2_2_num">Art. 2.2</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_2_2_titre">Responsabilit√©s</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_2_2_p1"><strong>M. Jad (CTO) :</strong> D√©veloppement, roadmap, √©quipe technique, support, image publique</p>
                                <p contenteditable="true" data-field="art_2_2_p2"><strong>KEF Ventures :</strong> Vision/strat√©gie, commercial B2B/B2C, finances, lev√©es de fonds, marketing</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 2.3 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_2_3_num">Art. 2.3</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_2_3_titre">Engagements</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_2_3_p1">‚Ä¢ <strong>Exclusivit√© :</strong> Fondateur temps plein | KEF min. [X] jours/mois</p>
                                <p contenteditable="true" data-field="art_2_3_p2">‚Ä¢ <strong>Confidentialit√© :</strong> 5 ans apr√®s fin</p>
                                <p contenteditable="true" data-field="art_2_3_p3">‚Ä¢ <strong>Non-d√©bauchage :</strong> 2 ans apr√®s cessation</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-break"></div>

            <!-- ===== PARTIE 3 ===== -->
            <div class="content-page" id="partie3">
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">3</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_partie3">Pacte d'Associ√©s</h2>
                    </div>

                    <!-- Art 3.1 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_3_1_num">Art. 3.1</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_3_1_titre">Majorit√©s</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <table class="legal-table">
                                    <tr>
                                        <th contenteditable="true" data-field="tab2_h1">D√©cision</th>
                                        <th contenteditable="true" data-field="tab2_h2">Majorit√©</th>
                                        <th contenteditable="true" data-field="tab2_h3">Exemples</th>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab2_r1_c1">Ordinaire</td>
                                        <td contenteditable="true" data-field="tab2_r1_c2">>50%</td>
                                        <td contenteditable="true" data-field="tab2_r1_c3">Comptes, affectation r√©sultat</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab2_r2_c1">Extraordinaire</td>
                                        <td contenteditable="true" data-field="tab2_r2_c2">‚â•75%</td>
                                        <td contenteditable="true" data-field="tab2_r2_c3">Statuts, augmentation capital</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab2_r3_c1">Strat√©gique</td>
                                        <td contenteditable="true" data-field="tab2_r3_c2">100%</td>
                                        <td contenteditable="true" data-field="tab2_r3_c3">Cession, dissolution</td>
                                    </tr>
                                </table>
                                <p contenteditable="true" data-field="art_3_1_p1"><strong>Veto KEF :</strong> Dilution <50%, engagements > 500.000 DH</p>
                                <p contenteditable="true" data-field="art_3_1_p2"><strong>Deadlock :</strong> N√©gociation (15j) ‚Üí M√©diation (30j) ‚Üí Buy-out ‚Üí Arbitrage CIMAC</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 3.2 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_3_2_num">Art. 3.2</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_3_2_titre">Cession</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_3_2_p1">‚Ä¢ <strong>Pr√©emption :</strong> 60 jours</p>
                                <p contenteditable="true" data-field="art_3_2_p2">‚Ä¢ <strong>Drag-along :</strong> Si offre 100% √† ‚â• 3x valorisation</p>
                                <p contenteditable="true" data-field="art_3_2_p3">‚Ä¢ <strong>Liquidation Preference :</strong> KEF r√©cup√®re apport + 8%/an en priorit√©</p>
                                <p contenteditable="true" data-field="art_3_2_p4">‚Ä¢ <strong>Valorisation :</strong> Multiple ARR (3-5x si <500k, 5-8x si 500k-2M, 8-12x si >2M)</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 3.3 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_3_3_num">Art. 3.3</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_3_3_titre">Clauses Startup</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_3_3_p1">‚Ä¢ <strong>Vesting :</strong> 4 ans, cliff 12 mois (25% au cliff, puis mensuel)</p>
                                <p contenteditable="true" data-field="art_3_3_p2">‚Ä¢ <strong>ESOP :</strong> 10% r√©serv√© salari√©s cl√©s</p>
                                <p contenteditable="true" data-field="art_3_3_p3">‚Ä¢ <strong>Good Leaver :</strong> Parts vest√©es √† juste valeur</p>
                                <p contenteditable="true" data-field="art_3_3_p4">‚Ä¢ <strong>Bad Leaver :</strong> Parts au nominal ou 50% valeur</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-break"></div>

            <!-- ===== PARTIE 4 ===== -->
            <div class="content-page" id="partie4">
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">4</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_partie4">Plan d'Action (24-36 mois)</h2>
                    </div>

                    <!-- Art 4.1 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_4_1_num">Art. 4.1</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_4_1_titre">Lev√©es de Fonds</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_4_1_p1"><strong>Fonds cibl√©s :</strong> Innov Invest, 212 Founders, Maroc Numeric Fund, ADD</p>
                                <table class="legal-table">
                                    <tr>
                                        <th contenteditable="true" data-field="tab3_h1">Phase</th>
                                        <th contenteditable="true" data-field="tab3_h2">P√©riode</th>
                                        <th contenteditable="true" data-field="tab3_h3">Montant</th>
                                        <th contenteditable="true" data-field="tab3_h4">Valorisation</th>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab3_r1_c1">Pre-Seed</td>
                                        <td contenteditable="true" data-field="tab3_r1_c2">M1-M6</td>
                                        <td contenteditable="true" data-field="tab3_r1_c3">500.000 DH</td>
                                        <td contenteditable="true" data-field="tab3_r1_c4">2.000.000 DH</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab3_r2_c1">Seed</td>
                                        <td contenteditable="true" data-field="tab3_r2_c2">M12-M18</td>
                                        <td contenteditable="true" data-field="tab3_r2_c3">2.000.000 DH</td>
                                        <td contenteditable="true" data-field="tab3_r2_c4">10.000.000 DH</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab3_r3_c1">S√©rie A</td>
                                        <td contenteditable="true" data-field="tab3_r3_c2">M24-M36</td>
                                        <td contenteditable="true" data-field="tab3_r3_c3">10.000.000 DH</td>
                                        <td contenteditable="true" data-field="tab3_r3_c4">50.000.000 DH</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Art 4.2 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_4_2_num">Art. 4.2</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_4_2_titre">Marketing & Commercial</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_4_2_p1"><strong>Canaux :</strong> SEO/SEA, LinkedIn, Instagram, YouTube, TikTok, Content, Influence</p>
                                <p contenteditable="true" data-field="art_4_2_p2"><strong>Budget :</strong> 15.000 DH/mois ‚Üí 60.000 DH/mois</p>
                                <p contenteditable="true" data-field="art_4_2_p3"><strong>Segments :</strong> Architectes, Promoteurs, Agences, BET, √âtudiants</p>
                                <p contenteditable="true" data-field="art_4_2_p4"><strong>Pricing :</strong> Starter 189 DH | Pro 489 DH | Business 1.200 DH</p>
                            </div>
                        </div>
                    </div>

                    <!-- Art 4.3 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_4_3_num">Art. 4.3</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_4_3_titre">Expansion</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_4_3_p1">‚Ä¢ <strong>Phase 1 (M12-18) :</strong> Afrique francophone (S√©n√©gal, C√¥te d'Ivoire, Tunisie)</p>
                                <p contenteditable="true" data-field="art_4_3_p2">‚Ä¢ <strong>Phase 2 (M18-30) :</strong> Moyen-Orient (EAU, Arabie Saoudite)</p>
                                <p contenteditable="true" data-field="art_4_3_p3">‚Ä¢ <strong>Phase 3 (M24-36) :</strong> Europe (France, Belgique)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="page-break"></div>

            <!-- ===== PARTIE 5 ===== -->
            <div class="content-page" id="partie5">
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">5</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_partie5">Dispositions Financi√®res</h2>
                    </div>

                    <!-- Art 5.1 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_5_1_num">Art. 5.1</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_5_1_titre">Budget</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <table class="legal-table">
                                    <tr>
                                        <th contenteditable="true" data-field="tab4_h1">Poste</th>
                                        <th contenteditable="true" data-field="tab4_h2">6 mois</th>
                                        <th contenteditable="true" data-field="tab4_h3">12 mois</th>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab4_r1_c1">D√©veloppement</td>
                                        <td contenteditable="true" data-field="tab4_r1_c2">120.000 DH</td>
                                        <td contenteditable="true" data-field="tab4_r1_c3">300.000 DH</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab4_r2_c1">Marketing</td>
                                        <td contenteditable="true" data-field="tab4_r2_c2">90.000 DH</td>
                                        <td contenteditable="true" data-field="tab4_r2_c3">270.000 DH</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab4_r3_c1">Commercial</td>
                                        <td contenteditable="true" data-field="tab4_r3_c2">60.000 DH</td>
                                        <td contenteditable="true" data-field="tab4_r3_c3">180.000 DH</td>
                                    </tr>
                                    <tr>
                                        <td contenteditable="true" data-field="tab4_r4_c1">Infrastructure</td>
                                        <td contenteditable="true" data-field="tab4_r4_c2">30.000 DH</td>
                                        <td contenteditable="true" data-field="tab4_r4_c3">80.000 DH</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Art 5.2 -->
                    <div class="subsection">
                        <div class="subsection-header">
                            <span class="subsection-number" contenteditable="true" data-field="art_5_2_num">Art. 5.2</span>
                            <h3 class="subsection-title" contenteditable="true" data-field="art_5_2_titre">Distribution & R√©mun√©ration</h3>
                        </div>
                        <div class="article">
                            <div class="article-content">
                                <p contenteditable="true" data-field="art_5_2_p1">‚Ä¢ <strong>Dividendes :</strong> Aucun pendant 5 ans, puis max 30%</p>
                                <p contenteditable="true" data-field="art_5_2_p2">‚Ä¢ <strong>Salaire G√©rant :</strong> [√† d√©terminer] DH/mois</p>
                                <p contenteditable="true" data-field="art_5_2_p3">‚Ä¢ <strong>Bonus :</strong> Max 5 mois sur objectifs</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dispositions Finales -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-number">¬ß</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_disp_finales">Dispositions Finales</h2>
                    </div>
                    <div class="article">
                        <div class="article-content">
                            <p contenteditable="true" data-field="disp_finales_p1">‚Ä¢ <strong>Entr√©e en vigueur :</strong> √Ä la signature</p>
                            <p contenteditable="true" data-field="disp_finales_p2">‚Ä¢ <strong>Immatriculation :</strong> Sous 60 jours</p>
                            <p contenteditable="true" data-field="disp_finales_p3">‚Ä¢ <strong>Droit applicable :</strong> Marocain | Tribunaux de Casablanca</p>
                        </div>
                    </div>
                    <div class="warning-box">
                        <div class="highlight-box-title" contenteditable="true" data-field="warning_title">‚ö†Ô∏è Avertissement</div>
                        <p contenteditable="true" data-field="warning_text">Ce protocole n'a pas valeur de conseil juridique d√©finitif. Consultez vos conseils respectifs avant signature.</p>
                    </div>
                </div>
            </div>

            <div class="page-break"></div>

            <!-- ===== SIGNATURES ===== -->
            <div class="content-page" id="signatures">
                <div class="signature-section">
                    <div class="section-header">
                        <div class="section-number">‚úç</div>
                        <h2 class="section-title" contenteditable="true" data-field="titre_signatures">Signatures</h2>
                    </div>
                    <p style="text-align:center;margin-bottom:12px" contenteditable="true" data-field="signatures_lieu">Fait √† ____________, le ____/____/2025</p>
                    <p style="text-align:center;margin-bottom:25px;color:var(--text-medium)" contenteditable="true" data-field="signatures_exemplaires">En deux (2) exemplaires originaux.</p>
                    <div class="signature-grid">
                        <div class="signature-box">
                            <div class="signature-label" contenteditable="true" data-field="sig1_label">Pour le Fondateur</div>
                            <div class="signature-name" contenteditable="true" data-field="sig1_name">Mr. Jad [NOM]</div>
                            <div class="signature-line" contenteditable="true" data-field="sig1_mention">Signature ¬´ Lu et approuv√© ¬ª</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-label" contenteditable="true" data-field="sig2_label">Pour KEF Ventures</div>
                            <div class="signature-name" contenteditable="true" data-field="sig2_name">Mr. Karim EL-FEKKAK</div>
                            <div class="signature-line" contenteditable="true" data-field="sig2_mention">Signature et cachet</div>
                        </div>
                    </div>
                </div>

                <!-- Annexes -->
                <div class="annexe" style="margin-top:40px">
                    <div class="annexe-header">
                        <span class="annexe-badge">Annexes</span>
                        <span class="annexe-title" contenteditable="true" data-field="annexes_titre">Documents √† joindre</span>
                    </div>
                    <div class="article-content">
                        <p contenteditable="true" data-field="annexes_liste">1. Description technique BLAN'LIA STUDIO | 2. Inventaire PI | 3. Business Plan | 4. Projections 5 ans | 5. Pacte d'Associ√©s d√©taill√©</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
const STORAGE_KEYS={FIREBASE_CONFIG:'blanlia_firebase_config',LOCAL_DATA:'blanlia_local_data',MODE:'blanlia_storage_mode'};
let firebaseApp=null,database=null,isOnline=false,userId=null,debounceTimers={};

document.addEventListener('DOMContentLoaded',init);

function init(){
    userId=generateUserId();
    const savedConfig=localStorage.getItem(STORAGE_KEYS.FIREBASE_CONFIG);
    const savedMode=localStorage.getItem(STORAGE_KEYS.MODE);
    if(savedMode==='offline'){
        hideModal();loadFromLocalStorage();setupEditableFields();updateConnectionStatus('offline');
    }else if(savedConfig){
        hideModal();
        try{initFirebase(JSON.parse(savedConfig))}catch(e){showModal()}
    }else{showModal()}
    setupEditableFields();
}

function generateUserId(){let id=localStorage.getItem('blanlia_user_id');if(!id){id='user_'+Math.random().toString(36).substr(2,9);localStorage.setItem('blanlia_user_id',id)}return id}
function showModal(){document.getElementById('configModal').classList.remove('hidden')}
function hideModal(){document.getElementById('configModal').classList.add('hidden')}
function switchTab(tab){document.querySelectorAll('.config-tab').forEach(t=>t.classList.remove('active'));document.querySelectorAll('.config-panel').forEach(p=>p.classList.remove('active'));document.querySelector(`.config-tab[onclick="switchTab('${tab}')"]`).classList.add('active');document.getElementById(`panel-${tab}`).classList.add('active')}
function showConfigStatus(type,message){const status=document.getElementById('configStatus');status.className=`config-status show ${type}`;status.innerHTML=type==='loading'?`<div class="spinner-small"></div><span>${message}</span>`:`<span>${message}</span>`}

async function connectFirebase(){
    const input=document.getElementById('firebaseConfigInput').value.trim();
    if(!input){showConfigStatus('error','‚ùå Collez votre configuration Firebase');return}
    showConfigStatus('loading','Connexion...');
    document.getElementById('btnConnect').disabled=true;
    try{
        let config;
        try{config=JSON.parse(input)}catch{
            const match=input.match(/\{[\s\S]*\}/);
            if(match){config=JSON.parse(match[0].replace(/(\w+):/g,'"$1":').replace(/'/g,'"').replace(/,\s*}/g,'}'))}
            else throw new Error('Format invalide')
        }
        if(!config.databaseURL&&config.projectId)config.databaseURL=`https://${config.projectId}-default-rtdb.firebaseio.com`;
        await initFirebase(config);
        localStorage.setItem(STORAGE_KEYS.FIREBASE_CONFIG,JSON.stringify(config));
        localStorage.setItem(STORAGE_KEYS.MODE,'firebase');
        showConfigStatus('success','‚úÖ Connect√© !');
        setTimeout(()=>{hideModal();showToast('Connect√© √† Firebase !','success')},1000)
    }catch(error){
        console.error(error);
        showConfigStatus('error',`‚ùå ${error.message}`);
        document.getElementById('btnConnect').disabled=false
    }
}

async function initFirebase(config){
    return new Promise((resolve,reject)=>{
        try{
            if(!firebase.apps.length)firebaseApp=firebase.initializeApp(config);
            else firebaseApp=firebase.app();
            database=firebase.database();
            const connectedRef=database.ref('.info/connected');
            connectedRef.on('value',(snap)=>{
                if(snap.val()===true){
                    isOnline=true;updateConnectionStatus('online');setupPresence();loadFromFirebase();listenToChanges();resolve()
                }else{isOnline=false;updateConnectionStatus('offline')}
            });
            setTimeout(()=>{if(!isOnline)reject(new Error('Timeout connexion'))},10000)
        }catch(error){reject(error)}
    })
}

function setupPresence(){
    if(!database||!userId)return;
    const userRef=database.ref(`presence/${userId}`);
    const connectedRef=database.ref('.info/connected');
    connectedRef.on('value',(snap)=>{
        if(snap.val()===true){
            userRef.onDisconnect().remove();
            userRef.set({online:true,lastSeen:firebase.database.ServerValue.TIMESTAMP})
        }
    });
    database.ref('presence').on('value',(snap)=>{
        const users=snap.val();
        updateUsersCount(users?Object.keys(users).length:1)
    })
}

function loadFromFirebase(){
    if(!database)return;
    showLoading('Chargement...');
    database.ref('content').once('value').then((snapshot)=>{
        const data=snapshot.val();
        if(data)applyDataToFields(data);
        updateLastSync();hideLoading()
    }).catch((error)=>{console.error(error);hideLoading();showToast('Erreur chargement','error')})
}

function listenToChanges(){
    if(!database)return;
    database.ref('content').on('child_changed',(snapshot)=>{
        const field=snapshot.key,value=snapshot.val();
        const element=document.querySelector(`[data-field="${field}"]`);
        if(element&&document.activeElement!==element){
            element.innerHTML=value;
            highlightRemoteEdit(element)
        }
        updateLastSync()
    });
    database.ref('content').on('child_added',(snapshot)=>{
        const field=snapshot.key,value=snapshot.val();
        const element=document.querySelector(`[data-field="${field}"]`);
        if(element&&document.activeElement!==element)element.innerHTML=value
    })
}

function syncToFirebase(field,value){
    if(!database||!isOnline){saveToLocalStorage();return}
    updateConnectionStatus('syncing');
    database.ref(`content/${field}`).set(value).then(()=>{
        updateConnectionStatus('online');updateLastSync()
    }).catch((error)=>{
        console.error(error);updateConnectionStatus('offline');showToast('Erreur sync','error')
    })
}

function highlightRemoteEdit(element){
    element.classList.add('remote-editing');
    setTimeout(()=>element.classList.remove('remote-editing'),2000)
}

function useOfflineMode(){
    localStorage.setItem(STORAGE_KEYS.MODE,'offline');
    hideModal();loadFromLocalStorage();updateConnectionStatus('offline');
    showToast('Mode hors-ligne activ√©','info')
}

function saveToLocalStorage(){
    const data={};
    document.querySelectorAll('[data-field]').forEach(el=>data[el.dataset.field]=el.innerHTML);
    localStorage.setItem(STORAGE_KEYS.LOCAL_DATA,JSON.stringify(data))
}

function loadFromLocalStorage(){
    const savedData=localStorage.getItem(STORAGE_KEYS.LOCAL_DATA);
    if(savedData)try{applyDataToFields(JSON.parse(savedData))}catch(e){console.error(e)}
}

function applyDataToFields(data){
    Object.keys(data).forEach(field=>{
        const element=document.querySelector(`[data-field="${field}"]`);
        if(element)element.innerHTML=data[field]
    })
}

function setupEditableFields(){
    document.querySelectorAll('[contenteditable="true"]').forEach(el=>{
        el.addEventListener('input',(e)=>{
            const field=e.target.dataset.field;
            const value=e.target.innerHTML;
            if(debounceTimers[field])clearTimeout(debounceTimers[field]);
            debounceTimers[field]=setTimeout(()=>{
                if(localStorage.getItem(STORAGE_KEYS.MODE)==='offline')saveToLocalStorage();
                else syncToFirebase(field,value)
            },500)
        });
        el.addEventListener('focus',()=>el.style.outline='none');
        el.addEventListener('blur',()=>{
            const field=el.dataset.field,value=el.innerHTML;
            if(localStorage.getItem(STORAGE_KEYS.MODE)==='offline')saveToLocalStorage();
            else syncToFirebase(field,value)
        });
        el.addEventListener('paste',(e)=>{
            e.preventDefault();
            const text=e.clipboardData.getData('text/plain');
            document.execCommand('insertText',false,text)
        })
    })
}

function updateConnectionStatus(status){
    const badge=document.getElementById('connectionBadge');
    const text=document.getElementById('connectionText');
    const usersBadge=document.getElementById('usersBadge');
    badge.className=`connection-badge ${status}`;
    switch(status){
        case'online':text.textContent='Synchronis√©';usersBadge.style.display='flex';break;
        case'syncing':text.textContent='Sync...';break;
        case'offline':text.textContent='Hors-ligne';usersBadge.style.display='none';break
    }
}

function updateUsersCount(count){document.getElementById('usersCount').textContent=count}
function updateLastSync(){const now=new Date(),time=now.toLocaleTimeString('fr-FR',{hour:'2-digit',minute:'2-digit'});document.getElementById('lastSync').textContent=`Sync: ${time}`}

function showToast(message,type='info'){
    const container=document.getElementById('toastContainer');
    const icons={success:'‚úì',error:'‚úï',warning:'‚ö†',info:'‚Ñπ'};
    const toast=document.createElement('div');
    toast.className=`toast ${type}`;
    toast.innerHTML=`<div class="toast-icon">${icons[type]}</div><div class="toast-message">${message}</div><button class="toast-close" onclick="this.parentElement.remove()">‚úï</button>`;
    container.appendChild(toast);
    setTimeout(()=>{toast.style.opacity='0';toast.style.transform='translateX(100px)';setTimeout(()=>toast.remove(),300)},4000)
}

function showLoading(text='Chargement...'){document.getElementById('loadingText').textContent=text;document.getElementById('loadingOverlay').classList.add('active')}
function hideLoading(){document.getElementById('loadingOverlay').classList.remove('active')}
function showSettings(){showModal();const savedConfig=localStorage.getItem(STORAGE_KEYS.FIREBASE_CONFIG);if(savedConfig)document.getElementById('firebaseConfigInput').value=savedConfig}

function restoreOriginal(){
    if(!confirm('‚ö†Ô∏è Restaurer version originale ?\n\nToutes les modifications seront perdues pour TOUS les utilisateurs.'))return;
    if(localStorage.getItem(STORAGE_KEYS.MODE)==='offline')localStorage.removeItem(STORAGE_KEYS.LOCAL_DATA);
    else if(database)database.ref('content').remove();
    showToast('Document restaur√©','success');
    location.reload()
}

function scrollToEl(id){const element=document.getElementById(id);if(element)element.scrollIntoView({behavior:'smooth',block:'start'})}

async function downloadPDF(){
    showLoading('G√©n√©ration PDF...');
    const element=document.getElementById('document');
    const editables=element.querySelectorAll('[contenteditable="true"]');
    editables.forEach(el=>{
        el.dataset.originalBg=el.style.background;
        el.dataset.originalBorder=el.style.border;
        el.dataset.originalBoxShadow=el.style.boxShadow;
        el.style.background='transparent';
        el.style.border='none';
        el.style.boxShadow='none'
    });
    const opt={
        margin:[10,10,10,10],
        filename:`Protocole_BLANLIA_${new Date().toISOString().split('T')[0]}.pdf`,
        image:{type:'jpeg',quality:0.98},
        html2canvas:{scale:2,useCORS:true},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'},
        pagebreak:{mode:['avoid-all','css','legacy']}
    };
    try{
        await html2pdf().set(opt).from(element).save();
        showToast('PDF t√©l√©charg√© !','success')
    }catch(error){
        console.error(error);
        showToast('Erreur g√©n√©ration','error')
    }finally{
        editables.forEach(el=>{
            el.style.background=el.dataset.originalBg||'';
            el.style.border=el.dataset.originalBorder||'';
            el.style.boxShadow=el.dataset.originalBoxShadow||''
        });
        hideLoading()
    }
}
    </script>
</body>
</html>
